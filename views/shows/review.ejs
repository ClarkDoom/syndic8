<%- include('../partials/html-head') %>
<%- include('../partials/nav') %>

<div class="container">
  <div class="row">
    <div class="col text-center">
      <h1>Review Details</h1>
    </div>
  </div>
</div>



Author: <%= review.author %> 
<br>

Title: <%= review.reviewTitle %> 
<br>

Review Content: <%= review.reviewContent %> 
<br>

Review Rating: <%= review.rating %> 

<h1>Leave A Comment</h1>

<form 
  id="add-comment-form" 
  action="/shows/<%= show._id %>/<%= review._id %>/add-comment"
  method="POST"
>
  <!-- add profile id variable to value -->
 

  <label for="reaction-select">Reaction:</label>
  <select name="reaction" id="reaction-select">
    <option value="👍">👍</option>
    <option value="👎">👎</option>
    <option value="😑">😑</option>
    <option value="😂">😂</option>
    <option value="🧠">🧠</option>
  </select>
  <br>
  <br>

  <label for="comment-text">Comment:</label>
  <br>
  <textarea name="commentText" id="comment-text" cols="30" rows="10"></textarea>
  <br>
  <button type="submit">Save comment</button>
</form>

<h1>Comments</h1>

<% if (review.comments.length) { %>
  <table>
    <thead>
      <tr>
        <!-- update to match comment model  -->
        <th>Commentor</th>
        <th>Comment Text</th>
        <th>Reaction</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
      <% let total = 0 %> 
      <% review.comments.forEach(function(comment) { %>
        <% total += comment.rating %>
        <tr>
          <td><%= comment.commentor %></td>
          <td><%= comment.commentText %></td>
          <td><%= comment.reaction %> </td>
          <td> 
            <form 
              action="/shows/<%= show._id %>/<%= review._id %>/<%= comment._id %>?_method=DELETE" 
              method="POST"
            >
              <button>Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
<% } else { %>
  <h3>No Comments Yet</h3>
<% } %>

<%- include('../partials/footer') %>